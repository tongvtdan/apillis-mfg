-- Simple delete script for inactive organizations
DELETE FROM review_checklist_items WHERE review_id IN (SELECT id FROM reviews WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE));
DELETE FROM reviews WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE);
DELETE FROM permission_audit_log WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE);
DELETE FROM user_feature_access WHERE feature_toggle_id IN (SELECT id FROM feature_toggles WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE));
DELETE FROM feature_toggles WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE);
DELETE FROM user_custom_roles WHERE custom_role_id IN (SELECT id FROM custom_roles WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE));
DELETE FROM role_permissions WHERE custom_role_id IN (SELECT id FROM custom_roles WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE));
DELETE FROM custom_roles WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE);
DELETE FROM user_permissions WHERE user_id IN (SELECT id FROM users WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE));
DELETE FROM approval_attachments WHERE approval_id IN (SELECT id FROM approvals WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE));
DELETE FROM approval_history WHERE approval_id IN (SELECT id FROM approvals WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE));
DELETE FROM approvals WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE);
DELETE FROM document_access_log WHERE document_id IN (SELECT id FROM documents WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE));
DELETE FROM document_versions WHERE document_id IN (SELECT id FROM documents WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE));
DELETE FROM documents WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE);
DELETE FROM project_sub_stage_progress WHERE project_id IN (SELECT id FROM projects WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE));
DELETE FROM projects WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE);
DELETE FROM workflow_definition_sub_stages WHERE workflow_definition_id IN (SELECT id FROM workflow_definitions WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE));
DELETE FROM workflow_definition_stages WHERE workflow_definition_id IN (SELECT id FROM workflow_definitions WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE));
DELETE FROM workflow_definitions WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE);
DELETE FROM workflow_sub_stages WHERE workflow_stage_id IN (SELECT id FROM workflow_stages WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE));
DELETE FROM workflow_stages WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE);
DELETE FROM notifications WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE);
DELETE FROM messages WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE);
DELETE FROM activity_log WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE);
DELETE FROM contacts WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE);
DELETE FROM users WHERE organization_id IN (SELECT id FROM organizations WHERE is_active = FALSE);
DELETE FROM organizations WHERE is_active = FALSE;
